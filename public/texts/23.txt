Задача 23
1.	Спроектируйте базу данных University для автоматизации учета информации о филиалах учебного заведения. 
Учебное заведение имеет несколько филиалов. Для каждого филиала должна храниться следующая информация: 
•	номер филиала (уникален, содержит только цифры);
•	адрес;
•	дата последнего подтверждения Государственной аккредитации. 
В учебном заведении хранится информация обо всех группах каждого из филиалов:
•	номер филиала, к которому относится группа;
•	Номер группы (уникален);
•	курс;
•	количество учащихся в группе.  
В СУБД MS SQL SERVER, используя команды определения данных создать базу данных.  Создать таблицы Филиал и Группа, для каждой таблицы определив первичные ключи. Определить в подчиненной таблице внешний ключ. Создать связь между таблицами с помощью внешнего ключа, обеспечив каскадное удаление и обновление данных. (+1)
2.	Используя команды манипулирования данными, добавить в созданные таблицы по пять записей, таких чтобы результаты нижеперечисленных запросов содержали не менее одной записи. (+1)
  
3.	Используя команды языка SQL, выполнить следующие действия:

1)	 Написать  запросы для получения следующей информации (результаты выполнения запросов не должны быть пустыми): Выведите адреса филиалов и номера групп для вех филиалов, проходивших Государственную аккредитацию осенью. (+1)
2)	Написать хранимую процедуру вычисляющую количество групп для заданного филиала. Номер филиала передается в процедуру в качестве параметра. (+2)
3)	Продемонстрировать вызов процедуры и проссмотр результата ее работы. (+1)


-- 1. Создание БД и таблиц
CREATE DATABASE University;
GO
USE University;
GO
CREATE TABLE Филиал (
    номер INT PRIMARY KEY CHECK (номер LIKE '[0-9]%'),
    адрес VARCHAR(255),
    дата_аккредитации DATE
);
GO
CREATE TABLE Группа (
    номер_группы INT PRIMARY KEY,
    номер_филиала INT,
    курс INT,
    количество_учащихся INT,
    FOREIGN KEY (номер_филиала) REFERENCES Филиал(номер)
    ON DELETE CASCADE ON UPDATE CASCADE
);
GO

-- 2. Вставка данных (обеспечиваем данные для выполнения запросов)
INSERT INTO Филиал (номер, адрес, дата_аккредитации) VALUES
(1, 'ул. Ленина, 1', '2023-10-10'),  -- Осень
(2, 'пр. Мира, 5', '2022-05-15'),
(3, 'ул. Гагарина, 20', '2023-09-20'), -- Осень
(4, 'ул. Пушкина, 7', '2024-01-05'),
(5, 'пр. Ленина, 15', '2023-11-22'); -- Осень

INSERT INTO Группа (номер_группы, номер_филиала, курс, количество_учащихся) VALUES
(101, 1, 3, 25),
(102, 1, 2, 30),
(201, 2, 1, 20),
(301, 3, 3, 22),
(302, 3, 1, 18),  -- Группа для филиала 3 (осень)
(401, 4, 2, 25),
(501, 5, 3, 18);


-- 3. SQL-запросы

-- 1) Филиалы с аккредитацией осенью
SELECT f.адрес, g.номер_группы
FROM Филиал f
JOIN Группа g ON f.номер = g.номер_филиала
WHERE MONTH(f.дата_аккредитации) BETWEEN 9 AND 11;


-- 2) Хранимая процедура для подсчета групп
GO
CREATE PROCEDURE КоличествоГрупп (@номер_филиала INT)
AS
BEGIN
    SELECT COUNT(*) AS количество_групп
    FROM Группа
    WHERE номер_филиала = @номер_филиала;
END;
GO


-- 3) Вызов процедуры и вывод результата
EXEC КоличествоГрупп @номер_филиала = 1; -- Выведет количество групп для филиала 1
EXEC КоличествоГрупп @номер_филиала = 3; -- Выведет количество групп для филиала 3 (осень)